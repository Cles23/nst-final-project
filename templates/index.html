<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Photo Editor</title>

  <link rel="stylesheet" href="{{ url_for('static', filename='style/reset.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='style/theme.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='style/layout.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='style/components.css') }}">

  <meta name="color-scheme" content="dark light" />
</head>
<body class="app">

  <!-- Header -->
  <header class="app-header">
    <h1 class="app-title">Photo Editor</h1>

    <nav class="tabs" role="tablist">
      <button class="tab is-active" data-tab="edit">Edit</button>
      <button class="tab" data-tab="crop">Transform</button>
      <button class="tab" data-tab="nst">Style</button>
    </nav>
  </header>

  <!-- Workspace -->
  <main class="workspace">

    <!-- File Operations -->
    <aside class="left-sidebar">
      
      <section class="sidebar-panel upload-panel">
        <h3>Import</h3>
        <input id="upload-input" type="file" accept="image/*" style="display: none;" />
        <button id="upload-btn" type="button">Choose Image</button>
        <p class="hint">PNG, JPG, JPEG, WEBP</p>
      </section>

      <section class="sidebar-panel">
        <h3>Export</h3>
        <div class="inline">
          <span class="text-sm text-secondary">Format</span>
          <select id="export-format">
            <option value="png">PNG</option>
            <option value="jpeg">JPEG</option>
            <option value="webp">WEBP</option>
          </select>
        </div>
        <button id="download-btn" type="button">Download</button>
      </section>

      <section class="sidebar-panel">
        <h3>Reset</h3>
        <button id="restart-btn" type="button" class="danger-btn">Start Over</button>
        <p class="hint">Clear all edits and start fresh</p>
      </section>

    </aside>

    <!-- Image Preview -->
    <section id="stage" class="stage">
      <div class="stage-inner">
        <img id="preview-image" class="preview-image" alt="Preview" />
        <div id="stage-placeholder" class="stage-placeholder">
          <p>Choose an image to get started</p>
        </div>
      </div>
    </section>

    <!-- Edit Controls -->
    <aside id="panels" class="panels">
      
      <!-- Edit Panel -->
      <section id="tab-edit" class="tab-panel is-active">
        <div class="subtabs">
          <button class="subtab is-active" data-subtab="light">Light</button>
          <button class="subtab" data-subtab="color">Color</button>
          <button class="subtab" data-subtab="detail">Detail</button>
        </div>

        <div class="controls">
          <!-- Light Controls -->
          <div id="subtab-light" class="subtab-panel is-active">
            
            <div class="control">
              <label for="exposure">Exposure</label>
              <div class="slider">
                <input type="range" id="exposure" min="-100" max="100" value="0" />
                <output id="exposure-out">0</output>
              </div>
            </div>

            <div class="control">
              <label for="contrast">Contrast</label>
              <div class="slider">
                <input type="range" id="contrast" min="-100" max="100" value="0" />
                <output id="contrast-out">0</output>
              </div>
            </div>

            <div class="control">
              <label for="whites">Whites</label>
              <div class="slider">
                <input type="range" id="whites" min="-100" max="100" value="0" />
                <output id="whites-out">0</output>
              </div>
            </div>

            <div class="control">
              <label for="blacks">Blacks</label>
              <div class="slider">
                <input type="range" id="blacks" min="-100" max="100" value="0" />
                <output id="blacks-out">0</output>
              </div>
            </div>

          </div>

          <!-- Color Controls -->
          <div id="subtab-color" class="subtab-panel">
            
            <div class="control">
              <label for="temperature">Temperature</label>
              <div class="slider">
                <input type="range" id="temperature" min="-100" max="100" value="0" />
                <output id="temperature-out">0</output>
              </div>
            </div>

            <div class="control">
              <label for="vibrance">Vibrance</label>
              <div class="slider">
                <input type="range" id="vibrance" min="-100" max="100" value="0" />
                <output id="vibrance-out">0</output>
              </div>
            </div>

            <div class="control">
              <label for="saturation">Saturation</label>
              <div class="slider">
                <input type="range" id="saturation" min="-100" max="100" value="0" />
                <output id="saturation-out">0</output>
              </div>
            </div>

          </div>

          <!-- Detail Controls -->
          <div id="subtab-detail" class="subtab-panel">
            
            <div class="control">
              <label for="sharpness">Sharpness</label>
              <div class="slider">
                <input type="range" id="sharpness" min="0" max="100" value="0" />
                <output id="sharpness-out">0</output>
              </div>
            </div>

            <div class="control">
              <label for="grain">Grain</label>
              <div class="slider">
                <input type="range" id="grain" min="0" max="100" value="0" />
                <output id="grain-out">0</output>
              </div>
            </div>

            <div class="control">
              <label for="dehaze">Clarity</label>
              <div class="slider">
                <input type="range" id="dehaze" min="0" max="100" value="0" />
                <output id="dehaze-out">0</output>
              </div>
            </div>

          </div>
        </div>
      </section>

      <!-- Transform Panel -->
      <section id="tab-crop" class="tab-panel">
        <div class="controls">
          
          <div class="control">
            <label for="zoom">Zoom</label>
            <div class="slider">
              <input type="range" id="zoom" min="1" max="5" step="0.01" value="1" />
              <output id="zoom-out">1.00</output>
            </div>
          </div>

          <div class="control">
            <label for="pan-x">Horizontal</label>
            <div class="slider">
              <input type="range" id="pan-x" min="-100" max="100" value="0" />
              <output id="pan-x-out">0</output>
            </div>
          </div>

          <div class="control">
            <label for="pan-y">Vertical</label>
            <div class="slider">
              <input type="range" id="pan-y" min="-100" max="100" value="0" />
              <output id="pan-y-out">0</output>
            </div>
          </div>

          <div class="control">
            <label for="rotation">Rotation</label>
            <div class="slider">
              <input type="range" id="rotation" min="0" max="360" value="0" />
              <output id="rotation-out">0</output>
            </div>
          </div>

          <button id="crop-reset-btn" type="button">Reset Transform</button>

        </div>
      </section>

      <!-- Style Panel -->
      <section id="tab-nst" class="tab-panel">
        <div class="controls">
          
          <div class="panel" id="style-panel">
            <h2>Style Transfer</h2>

            <div class="control">
              <label for="nst-method">Algorithm</label>
              <select id="nst-method">
                <option value="gatys">Gatys (Slow, High Quality)</option>
                <option value="adain">AdaIN (Fast)</option>
              </select>
              <p class="hint" id="method-hint">Gatys: 2-5 minutes, iterative optimization.</p>
            </div>

            <!-- Style upload (for both methods) -->
            <div class="control" id="style-upload-control">
              <label>Style Image</label>
              <input id="style-upload" type="file" accept="image/*" style="display: none;" />
              <button id="style-upload-btn" type="button">Choose Style</button>
              <div id="style-preview" style="display: none; margin-top: var(--s-2);">
                <img id="style-preview-img" style="max-width: 100%; height: 60px; object-fit: cover; border-radius: var(--r-sm);" />
              </div>
            </div>

            <div class="control" id="steps-control">
              <label for="nst-steps">Iterations</label>
              <div class="slider">
                <input type="range" id="nst-steps" min="100" max="1000" value="300" step="50" />
                <output id="nst-steps-out">300</output>
              </div>
            </div>

            <div class="control" id="style-strength-control" style="display: none;">
              <label for="style-strength">Style Strength</label>
              <div class="slider">
                <input type="range" id="style-strength" min="0" max="5" step="0.05" value="2.5" />
                <output id="style-strength-out">2.5</output>
              </div>
            </div>

            <button id="start-nst-btn" type="button" disabled>Apply Style Transfer</button>
            <div id="nst-progress" style="display: none;">
              <p class="hint">Processing... <span id="processing-time"></span></p>
            </div>

          </div>

        </div>
      </section>

    </aside>

  </main>

  <!-- Scripts -->
  <script src="/static/js/ui/tabs.js" defer></script>
  <script src="/static/js/features/upload.js" defer></script>
  <script src="/static/js/features/edit.js" defer></script>
  <script src="/static/js/features/crop.js" defer></script>
  <script src="/static/js/features/export.js" defer></script>
  <script src="/static/js/features/nst.js" defer></script>
</body>
</html>
